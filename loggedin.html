<!DOCTYPE html>
<html>
    <head>
        <title>DEW - After Login Redirect</title>
        <meta charset="UTF-8">
    </head>
    <body>
        <div>Redirecting...</div>
        <script type="text/javascript">
            var code = window.location.search.match(/code=[0-9a-f]*/)[0].substring(5);
            
            var xhr = new XMLHttpRequest();
            xhr.open('POST', "https://github.com/login/oauth/access_token?client_id=13479cb2e9dd5f762848&client_secret=1c1feea05904a92aee0eba0fe432c2915bdc0129&code=" + code, false);
            xhr.setRequestHeader("Accept", "application/json");
            xhr.send();
            var r = eval('(' + xhr.responseText + ')');
            alert(r.access_token);
            
            var whereTo = unescape(
                window.location.search.match(/state=[^&]*/)[0].substring(6)
            ) + window.location.search + "&token=" + access_token;
            window.location = whereTo;
        </script>
    </body>
</html>
